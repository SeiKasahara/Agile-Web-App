{% macro alerts_factors(chart_data) %}
    <section class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-gray-800 rounded-lg p-6 shadow hover:shadow-lg transition">
            <h2 class="text-xl font-bold mb-4">Custom Price Alerts</h2>
            <div class="w-full h-40 bg-gray-700 rounded-md flex items-center justify-center text-gray-400">
                <form id="alertForm" class="space-y-3">
                    <div>
                        <label for="fuelType" class="block text-sm font-medium text-gray-200">Fuel Type</label>
                        <select id="fuelType" class="mt-1 block w-full bg-gray-700 border border-gray-400 rounded-md">
                            {% for ds in chart_data.daily.datasets %}
                                <option value="{{ ds.label }}">{{ ds.label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div>
                        <label for="priceThreshold" class="block text-sm font-medium text-gray-200">Price
                            Threshold</label>
                        <input type="number" step="0.01" id="priceThreshold"
                               class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md px-2 py-1"/>
                    </div>
                    <button type="submit" class="px-3 py-1 bg-blue-600 rounded-md hover:bg-blue-700">Set Alert</button>
                </form>
                <ul id="alertsList" class="mt-4 text-gray-200"></ul>
            </div>
        </div>
        <div class="bg-gray-800 rounded-lg p-6 shadow hover:shadow-lg transition">
            <h2 class="text-xl font-bold mb-4">Crude Oil vs Fuel Price</h2>
            <div class="w-full h-40 bg-gray-700 rounded-md flex items-center justify-center text-gray-400">
                <canvas id="crudeFuelChart" class="w-full h-64"></canvas>
            </div>
        </div>
    </section>
    <script>
        (function () {
            // Handle Custom Price Alerts form
            const form = document.getElementById('alertForm');
            const alertsList = document.getElementById('alertsList');
            form.addEventListener('submit', function (e) {
                e.preventDefault();
                const type = document.getElementById('fuelType').value;
                const threshold = document.getElementById('priceThreshold').value;
                const li = document.createElement('li');
                li.textContent = `Alert set for ${type} at price ${threshold}`;
                alertsList.appendChild(li);
                form.reset();
            });

            // Render Crude Oil vs Fuel Price chart
            const labels = {{ chart_data.daily.labels | tojson }};
            const datasets = {{ chart_data.daily.datasets | tojson }};
            const ctx = document.getElementById('crudeFuelChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    scales: {x: {display: true}, y: {display: true}},
                    plugins: {legend: {position: 'top'}}
                }
            });
        })();
    </script>
{% endmacro %} 